plot.caption = element_text(color="#cccccc"),
#background
plot.background = element_rect(fill="#D1C6AA"),
panel.background = element_rect(fill="#D1C6AA"),
panel.grid = element_blank(),
#axes
axis.text.x = element_blank(),
axis.text.y = element_text(color="#432206"),
axis.title = element_blank(),
axis.ticks = element_blank()
#strip
)
region_ingredients_pivot %>% ggplot(aes(x=Percentage, y=Region)) +
geom_col(fill="#432206") +
geom_text(aes(label=paste0(Percentage, "%")), hjust=1.2, color="#D1C6AA") +
scale_y_discrete(limit=rev) +
coord_cartesian(expand=FALSE) +
facet_wrap(~Ingredient, nrow=2, scales = "free_x") +
labs(title = "Title",
subtitle = "Subtitle",
caption = "Moriah Taylor | @moriah_taylor58 | #TidyTuesday") +
theme(
#title
plot.title = element_text(color="#643E1C", hjust=0.5),
plot.subtitle = element_text(color="#643E1C", hjust=0.5),
plot.caption = element_text(color="#cccccc"),
plot.title.position = "plot",
plot.caption.position = "plot",
#background
plot.background = element_rect(fill="#D1C6AA"),
panel.background = element_rect(fill="#D1C6AA"),
panel.grid = element_blank(),
#axes
axis.text.x = element_blank(),
axis.text.y = element_text(color="#432206"),
axis.title = element_blank(),
axis.ticks = element_blank()
#strip
)
region_ingredients_pivot %>% ggplot(aes(x=Percentage, y=Region)) +
geom_col(fill="#432206") +
geom_text(aes(label=paste0(Percentage, "%")), hjust=1.2, color="#D1C6AA") +
scale_y_discrete(limit=rev) +
coord_cartesian(expand=FALSE) +
facet_wrap(~Ingredient, nrow=2, scales = "free_x") +
labs(title = "Title",
subtitle = "Subtitle",
caption = "Moriah Taylor | @moriah_taylor58 | #TidyTuesday") +
theme(
#title
plot.title = element_text(color="#643E1C", hjust=0.5),
plot.subtitle = element_text(color="#643E1C", hjust=0.5),
plot.caption = element_text(color="#cccccc"),
plot.title.position = "plot",
plot.caption.position = "plot",
#background
plot.background = element_rect(fill="#D1C6AA"),
panel.background = element_rect(fill="#D1C6AA"),
panel.grid = element_blank(),
#axes
axis.text.x = element_blank(),
axis.text.y = element_text(color="#432206"),
axis.title = element_blank(),
axis.ticks = element_blank(),
#strip
strip.background = element_rect(fill="#D1C6AA")
)
region_ingredients_pivot %>% ggplot(aes(x=Percentage, y=Region)) +
geom_col(fill="#432206") +
geom_text(aes(label=paste0(Percentage, "%")), hjust=1.15, color="#D1C6AA") +
scale_y_discrete(limit=rev) +
coord_cartesian(expand=FALSE) +
facet_wrap(~Ingredient, nrow=2, scales = "free_x") +
labs(title = "Title",
subtitle = "Subtitle",
caption = "Moriah Taylor | @moriah_taylor58 | #TidyTuesday") +
theme(
#title
plot.title = element_text(color="#643E1C", hjust=0.5),
plot.subtitle = element_text(color="#643E1C", hjust=0.5),
plot.caption = element_text(color="#cccccc"),
plot.title.position = "plot",
plot.caption.position = "plot",
#background
plot.background = element_rect(fill="#D1C6AA"),
panel.background = element_rect(fill="#D1C6AA"),
panel.grid = element_blank(),
#axes
axis.text.x = element_blank(),
axis.text.y = element_text(color="#432206"),
axis.title = element_blank(),
axis.ticks = element_blank(),
#strip
strip.background = element_rect(fill="#D1C6AA")
)
setwd("C:/Users/Moria/tidy-tuesday/2022_Week03")
font_add(family="regular", "Nunito-Bold.ttf")
font_add(family="bold", "ConcertOne-Regular.ttf")
showtext_auto()
region_ingredients_pivot %>% ggplot(aes(x=Percentage, y=Region)) +
geom_col(fill="#432206") +
geom_text(aes(label=paste0(Percentage, "%")), hjust=1.15, color="#D1C6AA") +
scale_y_discrete(limit=rev) +
coord_cartesian(expand=FALSE) +
facet_wrap(~Ingredient, nrow=2, scales = "free_x") +
labs(title = "Title",
subtitle = "Subtitle",
caption = "Moriah Taylor | @moriah_taylor58 | #TidyTuesday") +
theme(
#title
plot.title = element_text(color="#643E1C", hjust=0.5, family="bold"),
plot.subtitle = element_text(color="#643E1C", hjust=0.5, family="regular"),
plot.caption = element_text(color="#694e38", family="regular"),
plot.title.position = "plot",
plot.caption.position = "plot",
#background
plot.background = element_rect(fill="#D1C6AA"),
panel.background = element_rect(fill="#D1C6AA"),
panel.grid = element_blank(),
#axes
axis.text.x = element_blank(),
axis.text.y = element_text(color="#432206", family="regular"),
axis.title = element_blank(),
axis.ticks = element_blank(),
#strip
strip.background = element_rect(fill="#D1C6AA"),
strip.text = element_blank(color="black", family="bold")
)
region_ingredients_pivot %>% ggplot(aes(x=Percentage, y=Region)) +
geom_col(fill="#432206") +
geom_text(aes(label=paste0(Percentage, "%")), hjust=1.15, color="#D1C6AA") +
scale_y_discrete(limit=rev) +
coord_cartesian(expand=FALSE) +
facet_wrap(~Ingredient, nrow=2, scales = "free_x") +
labs(title = "Title",
subtitle = "Subtitle",
caption = "Moriah Taylor | @moriah_taylor58 | #TidyTuesday") +
theme(
#title
plot.title = element_text(color="#643E1C", hjust=0.5, family="bold"),
plot.subtitle = element_text(color="#643E1C", hjust=0.5, family="regular"),
plot.caption = element_text(color="#694e38", family="regular"),
plot.title.position = "plot",
plot.caption.position = "plot",
#background
plot.background = element_rect(fill="#D1C6AA"),
panel.background = element_rect(fill="#D1C6AA"),
panel.grid = element_blank(),
#axes
axis.text.x = element_blank(),
axis.text.y = element_text(color="#432206", family="regular"),
axis.title = element_blank(),
axis.ticks = element_blank(),
#strip
strip.background = element_rect(fill="#D1C6AA"),
strip.text = element_text(color="black", family="bold")
)
region_ingredients_pivot %>% ggplot(aes(x=Percentage, y=Region)) +
geom_col(fill="#432206") +
geom_text(aes(label=paste0(Percentage, "%")), hjust=1.15, color="#D1C6AA", family="regular") +
scale_y_discrete(limit=rev) +
coord_cartesian(expand=FALSE) +
facet_wrap(~Ingredient, nrow=2, scales = "free_x") +
labs(title = "Chocolate Bar Ingredients",
subtitle = "Percentage of chocolate bars in each region that list the ingredient",
caption = "Moriah Taylor | @moriah_taylor58 | #TidyTuesday") +
theme(
#title
plot.title = element_text(color="#643E1C", hjust=0.5, family="bold"),
plot.subtitle = element_text(color="#643E1C", hjust=0.5, family="regular"),
plot.caption = element_text(color="#7b6451", family="regular"),
plot.title.position = "plot",
plot.caption.position = "plot",
#background
plot.background = element_rect(fill="#D1C6AA"),
panel.background = element_rect(fill="#D1C6AA"),
panel.grid = element_blank(),
#axes
axis.text.x = element_blank(),
axis.text.y = element_text(color="#432206", family="regular"),
axis.title = element_blank(),
axis.ticks = element_blank(),
#strip
strip.background = element_rect(fill="#D1C6AA"),
strip.text = element_text(color="black", family="bold")
)
region_ingredients_pivot %>% ggplot(aes(x=Percentage, y=Region)) +
geom_col(fill="#432206") +
geom_text(aes(label=paste0(Percentage, "%")), hjust=1.15, color="#D1C6AA", family="regular") +
scale_y_discrete(limit=rev) +
coord_cartesian(expand=FALSE) +
facet_wrap(~Ingredient, nrow=2, scales = "free_x") +
labs(title = "Chocolate Bar Ingredients",
subtitle = "Percentage of chocolate bars in each region that list the ingredient",
caption = "Moriah Taylor | @moriah_taylor58 | #TidyTuesday") +
theme(
#title
plot.title = element_text(color="#643E1C", hjust=0.5, family="bold", size=45),
plot.subtitle = element_text(color="#643E1C", hjust=0.5, family="regular", size=30),
plot.caption = element_text(color="#7b6451", family="regular", hjust=0.5, size=20),
plot.title.position = "plot",
plot.caption.position = "plot",
#background
plot.background = element_rect(fill="#D1C6AA"),
panel.background = element_rect(fill="#D1C6AA"),
panel.grid = element_blank(),
#axes
axis.text.x = element_blank(),
axis.text.y = element_text(color="#432206", family="regular"),
axis.title = element_blank(),
axis.ticks = element_blank(),
#strip
strip.background = element_rect(fill="#D1C6AA"),
strip.text = element_text(color="black", family="bold", size=35)
)
chocolate_plot <- region_ingredients_pivot %>% ggplot(aes(x=Percentage, y=Region)) +
geom_col(fill="#432206") +
geom_text(aes(label=paste0(Percentage, "%")), hjust=1.15, color="#D1C6AA", family="regular") +
scale_y_discrete(limit=rev) +
coord_cartesian(expand=FALSE) +
facet_wrap(~Ingredient, nrow=2, scales = "free_x") +
labs(title = "Chocolate Bar Ingredients",
subtitle = "Percentage of chocolate bars in each region that list the ingredient",
caption = "Moriah Taylor | @moriah_taylor58 | #TidyTuesday") +
theme(
#title
plot.title = element_text(color="#643E1C", hjust=0.5, family="bold", size=45),
plot.subtitle = element_text(color="#643E1C", hjust=0.5, family="regular", size=30),
plot.caption = element_text(color="#7b6451", family="regular", hjust=0.5, size=20),
plot.title.position = "plot",
plot.caption.position = "plot",
#background
plot.background = element_rect(fill="#D1C6AA"),
panel.background = element_rect(fill="#D1C6AA"),
panel.grid = element_blank(),
#axes
axis.text.x = element_blank(),
axis.text.y = element_text(color="#432206", family="regular"),
axis.title = element_blank(),
axis.ticks = element_blank(),
#strip
strip.background = element_rect(fill="#D1C6AA"),
strip.text = element_text(color="black", family="bold", size=35)
)
ggsave("Chocolate_Ingredients.png",
chocolate_plot,
device = agg_png(width = 6, height = 6, units = "in", res = 300))
chocolate_plot <- region_ingredients_pivot %>% ggplot(aes(x=Percentage, y=Region)) +
geom_col(fill="#432206", width=0.8) +
geom_text(aes(label=paste0(Percentage, "%")), hjust=1.15, color="#D1C6AA", family="regular", size=16) +
scale_y_discrete(limit=rev) +
coord_cartesian(expand=FALSE) +
facet_wrap(~Ingredient, nrow=2, scales = "free_x") +
labs(title = "Chocolate Bar Ingredients",
subtitle = "Percentage of chocolate bars in each region that list the ingredient",
caption = "Moriah Taylor | @moriah_taylor58 | #TidyTuesday") +
theme(
#title
plot.title = element_text(color="#643E1C", hjust=0.5, family="bold", size=45),
plot.subtitle = element_text(color="#643E1C", hjust=0.5, family="regular", size=30),
plot.caption = element_text(color="#7b6451", family="regular", hjust=0.5, size=20),
plot.title.position = "plot",
plot.caption.position = "plot",
#background
plot.background = element_rect(fill="#D1C6AA"),
panel.background = element_rect(fill="#D1C6AA"),
panel.grid = element_blank(),
#axes
axis.text.x = element_blank(),
axis.text.y = element_text(color="#432206", family="regular", size=16),
axis.title = element_blank(),
axis.ticks = element_blank(),
#strip
strip.background = element_rect(fill="#D1C6AA"),
strip.text = element_text(color="black", family="bold", size=35)
)
ggsave("Chocolate_Ingredients.png",
chocolate_plot,
device = agg_png(width = 6, height = 6, units = "in", res = 300))
chocolate_plot <- region_ingredients_pivot %>% ggplot(aes(x=Percentage, y=Region)) +
geom_col(fill="#432206", width=0.5) +
geom_text(aes(label=paste0(Percentage, "%")), hjust=1.15, color="#D1C6AA", family="regular", size=16) +
scale_y_discrete(limit=rev) +
coord_cartesian(expand=FALSE) +
facet_wrap(~Ingredient, nrow=2, scales = "free_x") +
labs(title = "Chocolate Bar Ingredients",
subtitle = "Percentage of chocolate bars in each region that list the ingredient",
caption = "Moriah Taylor | @moriah_taylor58 | #TidyTuesday") +
theme(
#title
plot.title = element_text(color="#643E1C", hjust=0.5, family="bold", size=45),
plot.subtitle = element_text(color="#643E1C", hjust=0.5, family="regular", size=30),
plot.caption = element_text(color="#7b6451", family="regular", hjust=0.5, size=20),
plot.title.position = "plot",
plot.caption.position = "plot",
#background
plot.background = element_rect(fill="#D1C6AA"),
panel.background = element_rect(fill="#D1C6AA"),
panel.grid = element_blank(),
#axes
axis.text.x = element_blank(),
axis.text.y = element_text(color="#432206", family="regular", size=8),
axis.title = element_blank(),
axis.ticks = element_blank(),
#strip
strip.background = element_rect(fill="#D1C6AA"),
strip.text = element_text(color="black", family="bold", size=35)
)
ggsave("Chocolate_Ingredients.png",
chocolate_plot,
device = agg_png(width = 6, height = 6, units = "in", res = 300))
chocolate_plot <- region_ingredients_pivot %>% ggplot(aes(x=Percentage, y=Region)) +
geom_col(fill="#432206", width=0.5) +
geom_text(aes(label=paste0(Percentage, "%")), hjust=1.15, color="#D1C6AA", family="regular", size=8) +
scale_y_discrete(limit=rev) +
coord_cartesian(expand=FALSE) +
facet_wrap(~Ingredient, nrow=2, scales = "free_x") +
labs(title = "Chocolate Bar Ingredients",
subtitle = "Percentage of chocolate bars in each region that list the ingredient",
caption = "Moriah Taylor | @moriah_taylor58 | #TidyTuesday") +
theme(
#title
plot.title = element_text(color="#643E1C", hjust=0.5, family="bold", size=45),
plot.subtitle = element_text(color="#643E1C", hjust=0.5, family="regular", size=30),
plot.caption = element_text(color="#7b6451", family="regular", hjust=0.5, size=20),
plot.title.position = "plot",
plot.caption.position = "plot",
#background
plot.background = element_rect(fill="#D1C6AA"),
panel.background = element_rect(fill="#D1C6AA"),
panel.grid = element_blank(),
#axes
axis.text.x = element_blank(),
axis.text.y = element_text(color="#432206", family="regular", size=16),
axis.title = element_blank(),
axis.ticks = element_blank(),
#strip
strip.background = element_rect(fill="#D1C6AA"),
strip.text = element_text(color="black", family="bold", size=35)
)
ggsave("Chocolate_Ingredients.png",
chocolate_plot,
device = agg_png(width = 6, height = 6, units = "in", res = 300))
chocolate_plot <- region_ingredients_pivot %>% ggplot(aes(x=Percentage, y=Region)) +
geom_col(fill="#432206", width=0.5) +
geom_text(aes(label=paste0(Percentage, "%")), hjust=1.15, color="#D1C6AA", family="regular", size=8) +
scale_y_discrete(limit=rev) +
coord_cartesian(expand=FALSE) +
facet_wrap(~Ingredient, nrow=2, scales = "free_x") +
labs(title = "Chocolate Bar Ingredients",
subtitle = "Percentage of chocolate bars in each region that list the ingredient",
caption = "Moriah Taylor | @moriah_taylor58 | #TidyTuesday") +
theme(
#title
plot.title = element_text(color="#643E1C", hjust=0.5, family="bold", size=45),
plot.subtitle = element_text(color="#643E1C", hjust=0.5, family="regular", size=30),
plot.caption = element_text(color="#7b6451", family="regular", hjust=0.5, size=20),
plot.title.position = "plot",
plot.caption.position = "plot",
#background
plot.background = element_rect(fill="#D1C6AA"),
panel.background = element_rect(fill="#D1C6AA"),
panel.grid = element_blank(),
#axes
axis.text.x = element_blank(),
axis.text.y = element_text(color="#432206", family="regular", size=20),
axis.title = element_blank(),
axis.ticks = element_blank(),
#strip
strip.background = element_rect(fill="#D1C6AA"),
strip.text = element_text(color="black", family="bold", size=35)
)
ggsave("Chocolate_Ingredients.png",
chocolate_plot,
device = agg_png(width = 6, height = 6, units = "in", res = 300))
chocolate_subset <- chocolate %>% filter(country_of_bean_origin %in% country_list &
country_of_bean_origin != "Blend")
#put countries into lists that can specify region
north_amer <- c("Mexico", "U.S.A.")
central_amer <- c("Ecuador", "Nicaragua", "Belize", "Guatemala", "Costa Rica")
caribbean <- c("Dominican Republic", "Papua New Guinea", "Haiti", "Honduras", "Jamaica")
south_amer <- c("Venezuela", "Peru", "Bolivia", "Colombia", "Brazil")
africa <- c("Madagascar", "Tanzania", "Trinidad", "Ghana")
asia <- c("Vietnam", "India", "Philippines", "Indonesia")
#use lists to create Region variable using case_when and %in%
chocolate_subset <- chocolate_subset %>% mutate(Region = case_when(
country_of_bean_origin %in% north_amer ~ "North America",
country_of_bean_origin %in% central_amer ~ "Central America",
country_of_bean_origin %in% carribean ~ "Caribbean",
country_of_bean_origin %in% south_amer ~ "South America",
country_of_bean_origin %in% africa ~ "Africa",
country_of_bean_origin %in% asia ~ "Asia"
))
#get counts of each ingredient for each region
region_ingredient_counts <- chocolate_subset %>% group_by(Region) %>%
summarise(Beans = round(sum(beans)/n(),4)*100,
Cocoa = round(sum(cocoa)/n(),4)*100,
Sweetener = round(sum(sweetener)/n(),4)*100,
Lecithin = round(sum(lecithin)/n(),4)*100,
Salt = round(sum(salt)/n(),4)*100,
Sugar = round(sum(sugar)/n(),4)*100)
#pivot counts
region_ingredients_pivot <- region_ingredient_counts %>% pivot_longer(
cols = -c("Region"),
names_to = "Ingredient",
values_to = "Percentage"
)
#load fonts
font_add(family="regular", "Nunito-Bold.ttf")
font_add(family="bold", "ConcertOne-Regular.ttf")
showtext_auto()
#create plot
chocolate_plot <- region_ingredients_pivot %>% ggplot(aes(x=Percentage, y=Region)) +
geom_col(fill="#432206", width=0.5) +
geom_text(aes(label=paste0(Percentage, "%")), hjust=1.15, color="#D1C6AA", family="regular", size=8) +
scale_y_discrete(limit=rev) +
coord_cartesian(expand=FALSE) +
facet_wrap(~Ingredient, nrow=2, scales = "free_x") +
labs(title = "Chocolate Bar Ingredients",
subtitle = "Percentage of chocolate bars in each region that list the ingredient",
caption = "Moriah Taylor | @moriah_taylor58 | #TidyTuesday") +
theme(
#title
plot.title = element_text(color="#643E1C", hjust=0.5, family="bold", size=45),
plot.subtitle = element_text(color="#643E1C", hjust=0.5, family="regular", size=30),
plot.caption = element_text(color="#7b6451", family="regular", hjust=0.5, size=20),
plot.title.position = "plot",
plot.caption.position = "plot",
#background
plot.background = element_rect(fill="#D1C6AA"),
panel.background = element_rect(fill="#D1C6AA"),
panel.grid = element_blank(),
#axes
axis.text.x = element_blank(),
axis.text.y = element_text(color="#432206", family="regular", size=20),
axis.title = element_blank(),
axis.ticks = element_blank(),
#strip
strip.background = element_rect(fill="#D1C6AA"),
strip.text = element_text(color="black", family="bold", size=35)
)
#save plot
ggsave("Chocolate_Ingredients.png",
chocolate_plot,
device = agg_png(width = 6, height = 6, units = "in", res = 300))
north_amer <- c("Mexico", "U.S.A.")
central_amer <- c("Ecuador", "Nicaragua", "Belize", "Guatemala", "Costa Rica")
caribbean <- c("Dominican Republic", "Papua New Guinea", "Haiti", "Honduras", "Jamaica")
south_amer <- c("Venezuela", "Peru", "Bolivia", "Colombia", "Brazil")
africa <- c("Madagascar", "Tanzania", "Trinidad", "Ghana")
asia <- c("Vietnam", "India", "Philippines", "Indonesia")
#use lists to create Region variable using case_when and %in%
chocolate_subset <- chocolate_subset %>% mutate(Region = case_when(
country_of_bean_origin %in% north_amer ~ "North America",
country_of_bean_origin %in% central_amer ~ "Central America",
country_of_bean_origin %in% caribbean ~ "Caribbean",
country_of_bean_origin %in% south_amer ~ "South America",
country_of_bean_origin %in% africa ~ "Africa",
country_of_bean_origin %in% asia ~ "Asia"
))
#get counts of each ingredient for each region
region_ingredient_counts <- chocolate_subset %>% group_by(Region) %>%
summarise(Beans = round(sum(beans)/n(),4)*100,
Cocoa = round(sum(cocoa)/n(),4)*100,
Sweetener = round(sum(sweetener)/n(),4)*100,
Lecithin = round(sum(lecithin)/n(),4)*100,
Salt = round(sum(salt)/n(),4)*100,
Sugar = round(sum(sugar)/n(),4)*100)
#pivot counts
region_ingredients_pivot <- region_ingredient_counts %>% pivot_longer(
cols = -c("Region"),
names_to = "Ingredient",
values_to = "Percentage"
)
#load fonts
font_add(family="regular", "Nunito-Bold.ttf")
font_add(family="bold", "ConcertOne-Regular.ttf")
showtext_auto()
#create plot
chocolate_plot <- region_ingredients_pivot %>% ggplot(aes(x=Percentage, y=Region)) +
geom_col(fill="#432206", width=0.5) +
geom_text(aes(label=paste0(Percentage, "%")), hjust=1.15, color="#D1C6AA", family="regular", size=8) +
scale_y_discrete(limit=rev) +
coord_cartesian(expand=FALSE) +
facet_wrap(~Ingredient, nrow=2, scales = "free_x") +
labs(title = "Chocolate Bar Ingredients",
subtitle = "Percentage of chocolate bars in each region that list the ingredient",
caption = "Moriah Taylor | @moriah_taylor58 | #TidyTuesday") +
theme(
#title
plot.title = element_text(color="#643E1C", hjust=0.5, family="bold", size=45),
plot.subtitle = element_text(color="#643E1C", hjust=0.5, family="regular", size=30),
plot.caption = element_text(color="#7b6451", family="regular", hjust=0.5, size=20),
plot.title.position = "plot",
plot.caption.position = "plot",
#background
plot.background = element_rect(fill="#D1C6AA"),
panel.background = element_rect(fill="#D1C6AA"),
panel.grid = element_blank(),
#axes
axis.text.x = element_blank(),
axis.text.y = element_text(color="#432206", family="regular", size=20),
axis.title = element_blank(),
axis.ticks = element_blank(),
#strip
strip.background = element_rect(fill="#D1C6AA"),
strip.text = element_text(color="black", family="bold", size=35)
)
#save plot
ggsave("Chocolate_Ingredients.png",
chocolate_plot,
device = agg_png(width = 6, height = 6, units = "in", res = 300))
